{"ast":null,"code":"import _slicedToArray from\"/Users/subodhkalika/test-projects/projects/seismos_application/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{Button}from'antd';import TableHeadersUtil from\"util/TableHeaderUtil\";import Grid from\"components/Grid/Grid\";import _ from\"lodash\";import{Collapse}from'antd';import{Tooltip}from'antd';import NumberInput from\"components/Grid/DataEditor/NumberInput\";import ENUMS from\"constants/appEnums\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function WellVolume(props){var Panel=Collapse.Panel;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),wellVolumeGrids=_useState2[0],setWellVolumeGrids=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),wellVolumeEstimationsGrids=_useState4[0],setWellVolumeEstimationsGrids=_useState4[1];var getWellVolumeGridRow=function getWellVolumeGridRow(t){return t.rows.map(function(label){var columns=[];TableHeadersUtil.wellVolumeFormTableData.columns.map(function(column){var defaultVal=column.field===\"type\"?label:\"\";var col=null;if(column.field===\"type\"){col={value:defaultVal,field:column.field,readOnly:true,disableEvents:true};}else{col={value:defaultVal,field:column.field,required:column.required,dataEditor:NumberInput,datatype:column.datatype};}columns.push(col);return column;});return columns;});};var callback=function callback(key){};var getWellVolumeEstimationsGridRow=function getWellVolumeEstimationsGridRow(t){return t.rows.map(function(row){return[{value:\"\",field:row.field,datatype:row.datatype,dataEditor:NumberInput,readOnly:row.field===ENUMS.FORM_FIELDS.WELL_VOLUME_ESTIMATIONS.SURFACE_VOL?false:true},{value:row.label,readOnly:true,disableEvents:true}];});};var populateWellVolumeGrid=function populateWellVolumeGrid(index){var newWellVolGrid=TableHeadersUtil.wellVolumeFormTableData.grid.reduce(function(rows,t,rowIdx){return rows.concat(getWellVolumeGridRow(t));},[]);return newWellVolGrid;};var populateWellVolumeEstimationsGrid=function populateWellVolumeEstimationsGrid(index){var newWellVolEstimationsGrid=TableHeadersUtil.wellVolumeEstimationsFormTableData.grid.reduce(function(rows,t,rowIdx){return rows.concat(getWellVolumeEstimationsGridRow(t));},[]);return newWellVolEstimationsGrid;};var formatNumber=function formatNumber(numString){if(typeof numString===\"string\"){return parseFloat(numString.replace(/,/g,''));}else{return numString;}};var calculateHValue=function calculateHValue(gridDetail,index){var depthThisRow=gridDetail[index].find(function(g){return g.field===\"depth_md\";}).value||0;var tolThisRow=gridDetail[index].find(function(g){return g.field===\"tol\";}).value||0;var idThisRow=gridDetail[index].find(function(g){return g.field===\"id\";}).value||0;if(depthThisRow){if(index==2){var tolPreviousRow=gridDetail[index-1].find(function(g){return g.field===\"tol\";}).value||0;var diff=formatNumber(depthThisRow)-formatNumber(tolPreviousRow);return Math.pow(formatNumber(idThisRow),2)*0.0009714*diff;}else{var tolNextRow=gridDetail[index+1].find(function(g){return g.field===\"tol\";}).value||0;if(tolNextRow){return Math.pow(formatNumber(idThisRow),2)*0.0009714*(index==0?formatNumber(tolNextRow):formatNumber(tolNextRow)-formatNumber(tolThisRow));}else{return Math.pow(formatNumber(idThisRow),2)*0.0009714*(index==0?formatNumber(depthThisRow):formatNumber(depthThisRow)-formatNumber(tolThisRow));}}}};var calculateWellVolumeEstimations=function calculateWellVolumeEstimations(wellVolGridData,wellVolEstGridData,index){var hvalueCasing=calculateHValue(wellVolGridData,0);var hvalueLinear1=calculateHValue(wellVolGridData,1);var hvalueLinear2=calculateHValue(wellVolGridData,2);var totalHValue=(hvalueCasing||0)+(hvalueLinear1||0)+(hvalueLinear2||0);var newWellVolEstimationsGrid=_.cloneDeep(wellVolEstGridData?wellVolEstGridData:wellVolumeEstimationsGrids);var surfaveVol=newWellVolEstimationsGrid[index][0].find(function(wvG){return wvG.field===\"surface_vol\";}).value||0;var bbls=formatNumber(totalHValue)+formatNumber(surfaveVol);var gallons=bbls*42;newWellVolEstimationsGrid[index][1].find(function(k){return k.field===\"bbls\";}).value=bbls.toFixed();newWellVolEstimationsGrid[index][2].find(function(k){return k.field===\"gallons\";}).value=gallons.toFixed();props.setWellVolumeEstimationsFormValue(newWellVolEstimationsGrid);setWellVolumeEstimationsGrids(newWellVolEstimationsGrid);};var handleWellVolumeGridChanged=function handleWellVolumeGridChanged(updatedGridData,index){var newWellVolGrid=_.cloneDeep(wellVolumeGrids);calculateWellVolumeEstimations(updatedGridData,null,index);newWellVolGrid[index]=updatedGridData;props.setWellVolumeFormValue(newWellVolGrid);setWellVolumeGrids(newWellVolGrid);};var handleWellVolumeEstimationsGridChanged=function handleWellVolumeEstimationsGridChanged(updatedGridData,index){var newWellVolEstimationsGrid=_.cloneDeep(wellVolumeEstimationsGrids);newWellVolEstimationsGrid[index]=updatedGridData;calculateWellVolumeEstimations(wellVolumeGrids[index],newWellVolEstimationsGrid,index);};var gotoNextStep=function gotoNextStep(){var formValid=true;var checkWellVolumeGrids=_.cloneDeep(wellVolumeGrids);var validatedWellVolumeGrids=[];checkWellVolumeGrids.map(function(grid,index){var isWellVolumeValid=true;var validatedGrid=grid.map(function(row){var validatedRow=row.map(function(cell){if(cell.required&&cell.value===\"\"){isWellVolumeValid=false;formValid=false;cell.className='cell-error';cell.error=true;}return cell;});return validatedRow;});if(!isWellVolumeValid){validatedWellVolumeGrids.push({grid:validatedGrid,index:index});}return grid;});if(formValid){console.log('wellVolumeGrids',wellVolumeGrids);console.log('wellVolumeEstimationsGrids',wellVolumeEstimationsGrids);props.next();}else{var newWellVolGrid=_.cloneDeep(wellVolumeGrids);validatedWellVolumeGrids.map(function(gridData){newWellVolGrid[gridData.index]=gridData.grid;return gridData;});props.setWellVolumeFormValue(newWellVolGrid);setWellVolumeGrids(newWellVolGrid);}};useState(function(){if(props.wellInfoValues){var wellVolumeGridData=[];var wellVolumeEstimationsGridData=[];props.wellInfoValues.map(function(wellInfoValue,index){if(props.wellVolumeFormValues!=null&&props.wellVolumeFormValues[index]){wellVolumeGridData.push(props.wellVolumeFormValues[index]);}else{wellVolumeGridData.push(populateWellVolumeGrid(index));}if(props.wellVolumeEstimationsFormValues!=null&&props.wellVolumeEstimationsFormValues[index]){wellVolumeEstimationsGridData.push(props.wellVolumeEstimationsFormValues[index]);}else{wellVolumeEstimationsGridData.push(populateWellVolumeEstimationsGrid(index));}return wellInfoValue;});setWellVolumeGrids(wellVolumeGridData);setWellVolumeEstimationsGrids(wellVolumeEstimationsGridData);}},props);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Collapse,{defaultActiveKey:['1'],onChange:callback,children:props.wellInfoValues&&props.wellInfoValues.map(function(well,index){return/*#__PURE__*/_jsx(Panel,{header:well[0].value,extra:wellVolumeGrids[index]&&wellVolumeGrids[index].find(function(row){return row.find(function(cell){return cell.error;})?true:false;})?/*#__PURE__*/_jsx(Tooltip,{title:\"Please fill all the fields\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-exclamation-circle text-red-500\"})}):\"\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"well-volume-grid\",children:/*#__PURE__*/_jsx(Grid,{columns:TableHeadersUtil.wellVolumeFormTableData.columns,grid:wellVolumeGrids[index],gridValueChanged:handleWellVolumeGridChanged,index:index})}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"well-volume-estimation-grid\",children:/*#__PURE__*/_jsx(Grid,{columns:TableHeadersUtil.wellVolumeEstimationsFormTableData.columns(well[0].value),grid:wellVolumeEstimationsGrids[index],gridValueChanged:handleWellVolumeEstimationsGridChanged,index:index})})]},index)},index+1);})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right mt-8\",children:/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:function onClick(e){gotoNextStep();},children:\"Next\"})})]});}","map":{"version":3,"sources":["/Users/subodhkalika/test-projects/projects/seismos_application/client/src/components/Forms/ProjectCreate/WellVolume.js"],"names":["React","useState","Button","TableHeadersUtil","Grid","_","Collapse","Tooltip","NumberInput","ENUMS","WellVolume","props","Panel","wellVolumeGrids","setWellVolumeGrids","wellVolumeEstimationsGrids","setWellVolumeEstimationsGrids","getWellVolumeGridRow","t","rows","map","label","columns","wellVolumeFormTableData","column","defaultVal","field","col","value","readOnly","disableEvents","required","dataEditor","datatype","push","callback","key","getWellVolumeEstimationsGridRow","row","FORM_FIELDS","WELL_VOLUME_ESTIMATIONS","SURFACE_VOL","populateWellVolumeGrid","index","newWellVolGrid","grid","reduce","rowIdx","concat","populateWellVolumeEstimationsGrid","newWellVolEstimationsGrid","wellVolumeEstimationsFormTableData","formatNumber","numString","parseFloat","replace","calculateHValue","gridDetail","depthThisRow","find","g","tolThisRow","idThisRow","tolPreviousRow","diff","tolNextRow","calculateWellVolumeEstimations","wellVolGridData","wellVolEstGridData","hvalueCasing","hvalueLinear1","hvalueLinear2","totalHValue","cloneDeep","surfaveVol","wvG","bbls","gallons","k","toFixed","setWellVolumeEstimationsFormValue","handleWellVolumeGridChanged","updatedGridData","setWellVolumeFormValue","handleWellVolumeEstimationsGridChanged","gotoNextStep","formValid","checkWellVolumeGrids","validatedWellVolumeGrids","isWellVolumeValid","validatedGrid","validatedRow","cell","className","error","console","log","next","gridData","wellInfoValues","wellVolumeGridData","wellVolumeEstimationsGridData","wellInfoValue","wellVolumeFormValues","wellVolumeEstimationsFormValues","well","e"],"mappings":"4LAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,MAAT,KAAuB,MAAvB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,sBAA7B,CACA,MAAOC,CAAAA,IAAP,KAAiB,sBAAjB,CACA,MAAOC,CAAAA,CAAP,KAAc,QAAd,CACA,OAASC,QAAT,KAAyB,MAAzB,CACA,OAASC,OAAT,KAAwB,MAAxB,CACA,MAAOC,CAAAA,WAAP,KAAwB,wCAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,oBAAlB,C,6IAEA,cAAe,SAASC,CAAAA,UAAT,CAAoBC,KAApB,CAA2B,CACtC,GAAQC,CAAAA,KAAR,CAAkBN,QAAlB,CAAQM,KAAR,CACA,cAA8CX,QAAQ,CAAC,EAAD,CAAtD,wCAAOY,eAAP,eAAwBC,kBAAxB,eACA,eAAoEb,QAAQ,CAAC,EAAD,CAA5E,yCAAOc,0BAAP,eAAmCC,6BAAnC,eAEA,GAAMC,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACC,CAAD,CAAO,CAChC,MAAOA,CAAAA,CAAC,CAACC,IAAF,CAAOC,GAAP,CAAW,SAAAC,KAAK,CAAI,CACvB,GAAMC,CAAAA,OAAO,CAAG,EAAhB,CACAnB,gBAAgB,CAACoB,uBAAjB,CAAyCD,OAAzC,CAAiDF,GAAjD,CAAqD,SAAAI,MAAM,CAAI,CAC3D,GAAMC,CAAAA,UAAU,CAAGD,MAAM,CAACE,KAAP,GAAiB,MAAjB,CAA0BL,KAA1B,CAAkC,EAArD,CACA,GAAIM,CAAAA,GAAG,CAAG,IAAV,CACA,GAAIH,MAAM,CAACE,KAAP,GAAiB,MAArB,CAA6B,CACzBC,GAAG,CAAG,CACFC,KAAK,CAAEH,UADL,CAEFC,KAAK,CAAEF,MAAM,CAACE,KAFZ,CAGFG,QAAQ,CAAE,IAHR,CAIFC,aAAa,CAAE,IAJb,CAAN,CAMH,CAPD,IAOO,CACHH,GAAG,CAAG,CACFC,KAAK,CAAEH,UADL,CAEFC,KAAK,CAAEF,MAAM,CAACE,KAFZ,CAGFK,QAAQ,CAAEP,MAAM,CAACO,QAHf,CAIFC,UAAU,CAAExB,WAJV,CAKFyB,QAAQ,CAAET,MAAM,CAACS,QALf,CAAN,CAOH,CACDX,OAAO,CAACY,IAAR,CAAaP,GAAb,EACA,MAAOH,CAAAA,MAAP,CACH,CArBD,EAsBA,MAAOF,CAAAA,OAAP,CACH,CAzBM,CAAP,CA0BH,CA3BD,CA6BA,GAAMa,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,GAAD,CAAU,CAC1B,CADD,CAGA,GAAMC,CAAAA,+BAA+B,CAAG,QAAlCA,CAAAA,+BAAkC,CAACnB,CAAD,CAAO,CAC3C,MAAOA,CAAAA,CAAC,CAACC,IAAF,CAAOC,GAAP,CAAW,SAAAkB,GAAG,CAAI,CACrB,MAAO,CACH,CAAEV,KAAK,CAAE,EAAT,CAAaF,KAAK,CAAEY,GAAG,CAACZ,KAAxB,CAA+BO,QAAQ,CAAEK,GAAG,CAACL,QAA7C,CAAuDD,UAAU,CAAExB,WAAnE,CAAgFqB,QAAQ,CAAGS,GAAG,CAACZ,KAAJ,GAAcjB,KAAK,CAAC8B,WAAN,CAAkBC,uBAAlB,CAA0CC,WAAzD,CAAwE,KAAxE,CAAgF,IAA1K,CADG,CAEH,CAAEb,KAAK,CAAEU,GAAG,CAACjB,KAAb,CAAoBQ,QAAQ,CAAE,IAA9B,CAAoCC,aAAa,CAAE,IAAnD,CAFG,CAAP,CAIH,CALM,CAAP,CAMH,CAPD,CASA,GAAMY,CAAAA,sBAAsB,CAAG,QAAzBA,CAAAA,sBAAyB,CAACC,KAAD,CAAW,CACtC,GAAMC,CAAAA,cAAc,CAAGzC,gBAAgB,CAACoB,uBAAjB,CAAyCsB,IAAzC,CAA8CC,MAA9C,CAAqD,SAAC3B,IAAD,CAAOD,CAAP,CAAU6B,MAAV,CAAqB,CAC7F,MAAO5B,CAAAA,IAAI,CAAC6B,MAAL,CAAY/B,oBAAoB,CAACC,CAAD,CAAhC,CAAP,CACH,CAFsB,CAEpB,EAFoB,CAAvB,CAGA,MAAO0B,CAAAA,cAAP,CACH,CALD,CAOA,GAAMK,CAAAA,iCAAiC,CAAG,QAApCA,CAAAA,iCAAoC,CAACN,KAAD,CAAW,CACjD,GAAMO,CAAAA,yBAAyB,CAAG/C,gBAAgB,CAACgD,kCAAjB,CAAoDN,IAApD,CAAyDC,MAAzD,CAAgE,SAAC3B,IAAD,CAAOD,CAAP,CAAU6B,MAAV,CAAqB,CACnH,MAAO5B,CAAAA,IAAI,CAAC6B,MAAL,CAAYX,+BAA+B,CAACnB,CAAD,CAA3C,CAAP,CACH,CAFiC,CAE/B,EAF+B,CAAlC,CAGA,MAAOgC,CAAAA,yBAAP,CACH,CALD,CAOA,GAAME,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,SAAD,CAAe,CAChC,GAAI,MAAOA,CAAAA,SAAP,GAAqB,QAAzB,CAAmC,CAC/B,MAAOC,CAAAA,UAAU,CAACD,SAAS,CAACE,OAAV,CAAkB,IAAlB,CAAwB,EAAxB,CAAD,CAAjB,CACH,CAFD,IAEO,CACH,MAAOF,CAAAA,SAAP,CACH,CACJ,CAND,CAQA,GAAMG,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,UAAD,CAAad,KAAb,CAAuB,CAC3C,GAAMe,CAAAA,YAAY,CAAGD,UAAU,CAACd,KAAD,CAAV,CAAkBgB,IAAlB,CAAuB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAAClC,KAAF,GAAY,UAAhB,EAAxB,EAAoDE,KAApD,EAA6D,CAAlF,CACA,GAAMiC,CAAAA,UAAU,CAAGJ,UAAU,CAACd,KAAD,CAAV,CAAkBgB,IAAlB,CAAuB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAAClC,KAAF,GAAY,KAAhB,EAAxB,EAA+CE,KAA/C,EAAwD,CAA3E,CACA,GAAMkC,CAAAA,SAAS,CAAGL,UAAU,CAACd,KAAD,CAAV,CAAkBgB,IAAlB,CAAuB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAAClC,KAAF,GAAY,IAAhB,EAAxB,EAA8CE,KAA9C,EAAuD,CAAzE,CACA,GAAI8B,YAAJ,CAAkB,CACd,GAAIf,KAAK,EAAI,CAAb,CAAgB,CACZ,GAAMoB,CAAAA,cAAc,CAAGN,UAAU,CAACd,KAAK,CAAG,CAAT,CAAV,CAAsBgB,IAAtB,CAA2B,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAAClC,KAAF,GAAY,KAAhB,EAA5B,EAAmDE,KAAnD,EAA4D,CAAnF,CACA,GAAMoC,CAAAA,IAAI,CAAGZ,YAAY,CAACM,YAAD,CAAZ,CAA6BN,YAAY,CAACW,cAAD,CAAtD,CACA,MAAO,UAAAX,YAAY,CAACU,SAAD,CAAZ,CAA2B,CAA3B,EAA+B,SAA/B,CAA2CE,IAAlD,CACH,CAJD,IAIO,CACH,GAAMC,CAAAA,UAAU,CAAGR,UAAU,CAACd,KAAK,CAAG,CAAT,CAAV,CAAsBgB,IAAtB,CAA2B,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAAClC,KAAF,GAAY,KAAhB,EAA5B,EAAmDE,KAAnD,EAA4D,CAA/E,CACA,GAAIqC,UAAJ,CAAgB,CACZ,MAAO,UAAAb,YAAY,CAACU,SAAD,CAAZ,CAA2B,CAA3B,EAA+B,SAA/B,EAA4CnB,KAAK,EAAI,CAAT,CAAaS,YAAY,CAACa,UAAD,CAAzB,CAAyCb,YAAY,CAACa,UAAD,CAAZ,CAA2Bb,YAAY,CAACS,UAAD,CAA5H,CAAP,CACH,CAFD,IAEO,CACH,MAAO,UAAAT,YAAY,CAACU,SAAD,CAAZ,CAA2B,CAA3B,EAA+B,SAA/B,EAA4CnB,KAAK,EAAI,CAAT,CAAaS,YAAY,CAACM,YAAD,CAAzB,CAA2CN,YAAY,CAACM,YAAD,CAAZ,CAA6BN,YAAY,CAACS,UAAD,CAAhI,CAAP,CACH,CACJ,CACJ,CACJ,CAlBD,CAoBA,GAAMK,CAAAA,8BAA8B,CAAG,QAAjCA,CAAAA,8BAAiC,CAACC,eAAD,CAAkBC,kBAAlB,CAAsCzB,KAAtC,CAAgD,CACnF,GAAM0B,CAAAA,YAAY,CAAGb,eAAe,CAACW,eAAD,CAAkB,CAAlB,CAApC,CACA,GAAMG,CAAAA,aAAa,CAAGd,eAAe,CAACW,eAAD,CAAkB,CAAlB,CAArC,CACA,GAAMI,CAAAA,aAAa,CAAGf,eAAe,CAACW,eAAD,CAAkB,CAAlB,CAArC,CACA,GAAMK,CAAAA,WAAW,CAAG,CAACH,YAAY,EAAI,CAAjB,GAAuBC,aAAa,EAAI,CAAxC,GAA8CC,aAAa,EAAI,CAA/D,CAApB,CACA,GAAMrB,CAAAA,yBAAyB,CAAG7C,CAAC,CAACoE,SAAF,CAAYL,kBAAkB,CAAGA,kBAAH,CAAwBrD,0BAAtD,CAAlC,CACA,GAAM2D,CAAAA,UAAU,CAAGxB,yBAAyB,CAACP,KAAD,CAAzB,CAAiC,CAAjC,EAAoCgB,IAApC,CAAyC,SAAAgB,GAAG,QAAIA,CAAAA,GAAG,CAACjD,KAAJ,GAAc,aAAlB,EAA5C,EAA6EE,KAA7E,EAAsF,CAAzG,CACA,GAAMgD,CAAAA,IAAI,CAAGxB,YAAY,CAACoB,WAAD,CAAZ,CAA4BpB,YAAY,CAACsB,UAAD,CAArD,CACA,GAAMG,CAAAA,OAAO,CAAGD,IAAI,CAAG,EAAvB,CACA1B,yBAAyB,CAACP,KAAD,CAAzB,CAAiC,CAAjC,EAAoCgB,IAApC,CAAyC,SAAAmB,CAAC,QAAIA,CAAAA,CAAC,CAACpD,KAAF,GAAY,MAAhB,EAA1C,EAAkEE,KAAlE,CAA0EgD,IAAI,CAACG,OAAL,EAA1E,CACA7B,yBAAyB,CAACP,KAAD,CAAzB,CAAiC,CAAjC,EAAoCgB,IAApC,CAAyC,SAAAmB,CAAC,QAAIA,CAAAA,CAAC,CAACpD,KAAF,GAAY,SAAhB,EAA1C,EAAqEE,KAArE,CAA6EiD,OAAO,CAACE,OAAR,EAA7E,CACApE,KAAK,CAACqE,iCAAN,CAAwC9B,yBAAxC,EACAlC,6BAA6B,CAACkC,yBAAD,CAA7B,CACH,CAbD,CAeA,GAAM+B,CAAAA,2BAA2B,CAAG,QAA9BA,CAAAA,2BAA8B,CAACC,eAAD,CAAkBvC,KAAlB,CAA4B,CAC5D,GAAMC,CAAAA,cAAc,CAAGvC,CAAC,CAACoE,SAAF,CAAY5D,eAAZ,CAAvB,CACAqD,8BAA8B,CAACgB,eAAD,CAAkB,IAAlB,CAAwBvC,KAAxB,CAA9B,CACAC,cAAc,CAACD,KAAD,CAAd,CAAwBuC,eAAxB,CACAvE,KAAK,CAACwE,sBAAN,CAA6BvC,cAA7B,EACA9B,kBAAkB,CAAC8B,cAAD,CAAlB,CACH,CAND,CAQA,GAAMwC,CAAAA,sCAAsC,CAAG,QAAzCA,CAAAA,sCAAyC,CAACF,eAAD,CAAkBvC,KAAlB,CAA4B,CACvE,GAAMO,CAAAA,yBAAyB,CAAG7C,CAAC,CAACoE,SAAF,CAAY1D,0BAAZ,CAAlC,CACAmC,yBAAyB,CAACP,KAAD,CAAzB,CAAmCuC,eAAnC,CACAhB,8BAA8B,CAACrD,eAAe,CAAC8B,KAAD,CAAhB,CAAyBO,yBAAzB,CAAoDP,KAApD,CAA9B,CACH,CAJD,CAMA,GAAM0C,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvB,GAAIC,CAAAA,SAAS,CAAG,IAAhB,CACA,GAAMC,CAAAA,oBAAoB,CAAGlF,CAAC,CAACoE,SAAF,CAAY5D,eAAZ,CAA7B,CACA,GAAI2E,CAAAA,wBAAwB,CAAG,EAA/B,CACAD,oBAAoB,CAACnE,GAArB,CAAyB,SAACyB,IAAD,CAAOF,KAAP,CAAiB,CACtC,GAAI8C,CAAAA,iBAAiB,CAAG,IAAxB,CACA,GAAMC,CAAAA,aAAa,CAAG7C,IAAI,CAACzB,GAAL,CAAS,SAAAkB,GAAG,CAAI,CAClC,GAAMqD,CAAAA,YAAY,CAAGrD,GAAG,CAAClB,GAAJ,CAAQ,SAAAwE,IAAI,CAAI,CACjC,GAAGA,IAAI,CAAC7D,QAAL,EAAiB6D,IAAI,CAAChE,KAAL,GAAe,EAAnC,CAAuC,CACnC6D,iBAAiB,CAAG,KAApB,CACAH,SAAS,CAAG,KAAZ,CACAM,IAAI,CAACC,SAAL,CAAiB,YAAjB,CACAD,IAAI,CAACE,KAAL,CAAa,IAAb,CACH,CACD,MAAOF,CAAAA,IAAP,CACH,CARoB,CAArB,CASA,MAAOD,CAAAA,YAAP,CACH,CAXqB,CAAtB,CAaA,GAAG,CAACF,iBAAJ,CAAuB,CACnBD,wBAAwB,CAACtD,IAAzB,CAA8B,CAACW,IAAI,CAAE6C,aAAP,CAAsB/C,KAAK,CAAEA,KAA7B,CAA9B,EACH,CAED,MAAOE,CAAAA,IAAP,CACH,CApBD,EAsBA,GAAGyC,SAAH,CAAc,CACVS,OAAO,CAACC,GAAR,CAAY,iBAAZ,CAA+BnF,eAA/B,EACAkF,OAAO,CAACC,GAAR,CAAY,4BAAZ,CAA0CjF,0BAA1C,EACAJ,KAAK,CAACsF,IAAN,GACH,CAJD,IAIO,CACH,GAAMrD,CAAAA,cAAc,CAAGvC,CAAC,CAACoE,SAAF,CAAY5D,eAAZ,CAAvB,CACA2E,wBAAwB,CAACpE,GAAzB,CAA6B,SAAA8E,QAAQ,CAAI,CACrCtD,cAAc,CAACsD,QAAQ,CAACvD,KAAV,CAAd,CAAiCuD,QAAQ,CAACrD,IAA1C,CACA,MAAOqD,CAAAA,QAAP,CACH,CAHD,EAIAvF,KAAK,CAACwE,sBAAN,CAA6BvC,cAA7B,EACA9B,kBAAkB,CAAC8B,cAAD,CAAlB,CACH,CACJ,CAvCD,CAyCA3C,QAAQ,CAAC,UAAM,CACX,GAAGU,KAAK,CAACwF,cAAT,CAAyB,CACrB,GAAIC,CAAAA,kBAAkB,CAAG,EAAzB,CACA,GAAIC,CAAAA,6BAA6B,CAAG,EAApC,CACA1F,KAAK,CAACwF,cAAN,CAAqB/E,GAArB,CAAyB,SAACkF,aAAD,CAAgB3D,KAAhB,CAA0B,CAC/C,GAAGhC,KAAK,CAAC4F,oBAAN,EAA8B,IAA9B,EAAsC5F,KAAK,CAAC4F,oBAAN,CAA2B5D,KAA3B,CAAzC,CAA4E,CACxEyD,kBAAkB,CAAClE,IAAnB,CAAwBvB,KAAK,CAAC4F,oBAAN,CAA2B5D,KAA3B,CAAxB,EACH,CAFD,IAEO,CACHyD,kBAAkB,CAAClE,IAAnB,CAAwBQ,sBAAsB,CAACC,KAAD,CAA9C,EACH,CACD,GAAGhC,KAAK,CAAC6F,+BAAN,EAAyC,IAAzC,EAAiD7F,KAAK,CAAC6F,+BAAN,CAAsC7D,KAAtC,CAApD,CAAkG,CAC9F0D,6BAA6B,CAACnE,IAA9B,CAAmCvB,KAAK,CAAC6F,+BAAN,CAAsC7D,KAAtC,CAAnC,EACH,CAFD,IAEO,CACH0D,6BAA6B,CAACnE,IAA9B,CAAmCe,iCAAiC,CAACN,KAAD,CAApE,EACH,CACD,MAAO2D,CAAAA,aAAP,CACH,CAZD,EAaAxF,kBAAkB,CAACsF,kBAAD,CAAlB,CACApF,6BAA6B,CAACqF,6BAAD,CAA7B,CACH,CACJ,CApBO,CAoBL1F,KApBK,CAAR,CAsBA,mBACI,wCACI,KAAC,QAAD,EAAU,gBAAgB,CAAE,CAAC,GAAD,CAA5B,CAAmC,QAAQ,CAAEwB,QAA7C,UAEIxB,KAAK,CAACwF,cAAN,EAAwBxF,KAAK,CAACwF,cAAN,CAAqB/E,GAArB,CAAyB,SAACqF,IAAD,CAAO9D,KAAP,CAAiB,CAC9D,mBAAO,KAAC,KAAD,EACH,MAAM,CAAE8D,IAAI,CAAC,CAAD,CAAJ,CAAQ7E,KADb,CAGH,KAAK,CACDf,eAAe,CAAC8B,KAAD,CAAf,EAA0B9B,eAAe,CAAC8B,KAAD,CAAf,CAAuBgB,IAAvB,CAA4B,SAAArB,GAAG,QAAIA,CAAAA,GAAG,CAACqB,IAAJ,CAAS,SAAAiC,IAAI,QAAIA,CAAAA,IAAI,CAACE,KAAT,EAAb,EAA+B,IAA/B,CAAsC,KAA1C,EAA/B,CAA1B,cACE,KAAC,OAAD,EAAS,KAAK,CAAC,4BAAf,uBAA4C,UAAG,SAAS,CAAC,wCAAb,EAA5C,EADF,CAEE,EANH,uBASH,aAAK,SAAS,CAAC,MAAf,wBACI,YAAK,SAAS,CAAC,kBAAf,uBACI,KAAC,IAAD,EACI,OAAO,CAAE3F,gBAAgB,CAACoB,uBAAjB,CAAyCD,OADtD,CAEI,IAAI,CAAET,eAAe,CAAC8B,KAAD,CAFzB,CAGI,gBAAgB,CAAEsC,2BAHtB,CAII,KAAK,CAAEtC,KAJX,EADJ,EADJ,cASI,YAAK,SAAS,CAAC,KAAf,EATJ,cAUI,YAAK,SAAS,CAAC,6BAAf,uBACI,KAAC,IAAD,EACI,OAAO,CAAExC,gBAAgB,CAACgD,kCAAjB,CAAoD7B,OAApD,CAA4DmF,IAAI,CAAC,CAAD,CAAJ,CAAQ7E,KAApE,CADb,CAEI,IAAI,CAAEb,0BAA0B,CAAC4B,KAAD,CAFpC,CAGI,gBAAgB,CAAEyC,sCAHtB,CAII,KAAK,CAAEzC,KAJX,EADJ,EAVJ,GAA2BA,KAA3B,CATG,EAEEA,KAAK,CAAC,CAFR,CAAP,CA6BH,CA9BuB,CAF5B,EADJ,cAoCI,YAAK,SAAS,CAAC,iBAAf,uBACI,KAAC,MAAD,EAAQ,IAAI,CAAC,SAAb,CAAuB,OAAO,CAAE,iBAAC+D,CAAD,CAAO,CAACrB,YAAY,GAAG,CAAvD,kBADJ,EApCJ,GADJ,CA4CH","sourcesContent":["import React, { useState } from \"react\";\nimport { Button } from 'antd';\nimport TableHeadersUtil from \"util/TableHeaderUtil\";\nimport Grid from \"components/Grid/Grid\";\nimport _ from \"lodash\";\nimport { Collapse } from 'antd';\nimport { Tooltip } from 'antd';\nimport NumberInput from \"components/Grid/DataEditor/NumberInput\";\nimport ENUMS from \"constants/appEnums\";\n\nexport default function WellVolume(props) {\n    const { Panel } = Collapse;\n    const [wellVolumeGrids, setWellVolumeGrids] = useState([]);\n    const [wellVolumeEstimationsGrids, setWellVolumeEstimationsGrids] = useState([]);\n\n    const getWellVolumeGridRow = (t) => {\n        return t.rows.map(label => {\n            const columns = [];\n            TableHeadersUtil.wellVolumeFormTableData.columns.map(column => {\n                const defaultVal = column.field === \"type\" ? label : \"\";\n                let col = null;\n                if (column.field === \"type\") {\n                    col = { \n                        value: defaultVal,\n                        field: column.field,\n                        readOnly: true,\n                        disableEvents: true\n                    }\n                } else {\n                    col = { \n                        value: defaultVal,\n                        field: column.field,\n                        required: column.required,\n                        dataEditor: NumberInput,\n                        datatype: column.datatype\n                    }\n                }\n                columns.push(col);\n                return column;\n            })\n            return columns;\n        });\n    }\n\n    const callback = (key)  => {\n    }\n\n    const getWellVolumeEstimationsGridRow = (t) => {\n        return t.rows.map(row => {\n            return [\n                { value: \"\", field: row.field, datatype: row.datatype, dataEditor: NumberInput, readOnly: (row.field === ENUMS.FORM_FIELDS.WELL_VOLUME_ESTIMATIONS.SURFACE_VOL) ? false : true },\n                { value: row.label, readOnly: true, disableEvents: true }\n            ]\n        })\n    }\n\n    const populateWellVolumeGrid = (index) => {\n        const newWellVolGrid = TableHeadersUtil.wellVolumeFormTableData.grid.reduce((rows, t, rowIdx) => {\n            return rows.concat(getWellVolumeGridRow(t));\n        }, []);\n        return newWellVolGrid;\n    }\n\n    const populateWellVolumeEstimationsGrid = (index) => {\n        const newWellVolEstimationsGrid = TableHeadersUtil.wellVolumeEstimationsFormTableData.grid.reduce((rows, t, rowIdx) => {\n            return rows.concat(getWellVolumeEstimationsGridRow(t));\n        }, []);\n        return newWellVolEstimationsGrid;\n    }\n\n    const formatNumber = (numString) => {\n        if (typeof numString === \"string\") {\n            return parseFloat(numString.replace(/,/g, ''));\n        } else {\n            return numString;\n        }\n    }\n    \n    const calculateHValue = (gridDetail, index) => {\n        const depthThisRow = gridDetail[index].find(g => g.field === \"depth_md\").value || 0;\n        const tolThisRow = gridDetail[index].find(g => g.field === \"tol\").value || 0;\n        const idThisRow = gridDetail[index].find(g => g.field === \"id\").value || 0;\n        if (depthThisRow) {\n            if (index == 2) {\n                const tolPreviousRow = gridDetail[index - 1].find(g => g.field === \"tol\").value || 0;\n                const diff = formatNumber(depthThisRow) - formatNumber(tolPreviousRow);\n                return formatNumber(idThisRow) ** 2 * 0.0009714 * diff;\n            } else {\n                const tolNextRow = gridDetail[index + 1].find(g => g.field === \"tol\").value || 0;\n                if (tolNextRow) {\n                    return formatNumber(idThisRow) ** 2 * 0.0009714 * (index == 0 ? formatNumber(tolNextRow) : (formatNumber(tolNextRow) - formatNumber(tolThisRow)));\n                } else {\n                    return formatNumber(idThisRow) ** 2 * 0.0009714 * (index == 0 ? formatNumber(depthThisRow) : (formatNumber(depthThisRow) - formatNumber(tolThisRow)));\n                }\n            }\n        }\n    }\n\n    const calculateWellVolumeEstimations = (wellVolGridData, wellVolEstGridData, index) => {\n        const hvalueCasing = calculateHValue(wellVolGridData, 0);\n        const hvalueLinear1 = calculateHValue(wellVolGridData, 1);\n        const hvalueLinear2 = calculateHValue(wellVolGridData, 2);\n        const totalHValue = (hvalueCasing || 0) + (hvalueLinear1 || 0) + (hvalueLinear2 || 0);\n        const newWellVolEstimationsGrid = _.cloneDeep(wellVolEstGridData ? wellVolEstGridData : wellVolumeEstimationsGrids);\n        const surfaveVol = newWellVolEstimationsGrid[index][0].find(wvG => wvG.field === \"surface_vol\").value || 0;\n        const bbls = formatNumber(totalHValue) + formatNumber(surfaveVol);\n        const gallons = bbls * 42;\n        newWellVolEstimationsGrid[index][1].find(k => k.field === \"bbls\").value = bbls.toFixed();\n        newWellVolEstimationsGrid[index][2].find(k => k.field === \"gallons\").value = gallons.toFixed();\n        props.setWellVolumeEstimationsFormValue(newWellVolEstimationsGrid);\n        setWellVolumeEstimationsGrids(newWellVolEstimationsGrid);\n    }\n\n    const handleWellVolumeGridChanged = (updatedGridData, index) => {\n        const newWellVolGrid = _.cloneDeep(wellVolumeGrids);\n        calculateWellVolumeEstimations(updatedGridData, null, index);\n        newWellVolGrid[index] = updatedGridData;\n        props.setWellVolumeFormValue(newWellVolGrid);\n        setWellVolumeGrids(newWellVolGrid);\n    }\n\n    const handleWellVolumeEstimationsGridChanged = (updatedGridData, index) => {\n        const newWellVolEstimationsGrid = _.cloneDeep(wellVolumeEstimationsGrids);\n        newWellVolEstimationsGrid[index] = updatedGridData;\n        calculateWellVolumeEstimations(wellVolumeGrids[index], newWellVolEstimationsGrid, index);\n    }\n\n    const gotoNextStep = () => {\n        let formValid = true;\n        const checkWellVolumeGrids = _.cloneDeep(wellVolumeGrids);\n        let validatedWellVolumeGrids = [];\n        checkWellVolumeGrids.map((grid, index) => {\n            let isWellVolumeValid = true;\n            const validatedGrid = grid.map(row => {\n                const validatedRow = row.map(cell => {\n                    if(cell.required && cell.value === \"\") {\n                        isWellVolumeValid = false;\n                        formValid = false;\n                        cell.className = 'cell-error';\n                        cell.error = true;\n                    }\n                    return cell;\n                })\n                return validatedRow;\n            })\n            \n            if(!isWellVolumeValid) {\n                validatedWellVolumeGrids.push({grid: validatedGrid, index: index});\n            }\n\n            return grid;\n        });\n        \n        if(formValid) {\n            console.log('wellVolumeGrids', wellVolumeGrids)\n            console.log('wellVolumeEstimationsGrids', wellVolumeEstimationsGrids)\n            props.next();\n        } else {\n            const newWellVolGrid = _.cloneDeep(wellVolumeGrids);\n            validatedWellVolumeGrids.map(gridData => {\n                newWellVolGrid[gridData.index] = gridData.grid;\n                return gridData;\n            })\n            props.setWellVolumeFormValue(newWellVolGrid);\n            setWellVolumeGrids(newWellVolGrid);\n        }\n    }\n\n    useState(() => {\n        if(props.wellInfoValues) {\n            let wellVolumeGridData = [];\n            let wellVolumeEstimationsGridData = [];\n            props.wellInfoValues.map((wellInfoValue, index) => {\n                if(props.wellVolumeFormValues != null && props.wellVolumeFormValues[index]) {\n                    wellVolumeGridData.push(props.wellVolumeFormValues[index])\n                } else {\n                    wellVolumeGridData.push(populateWellVolumeGrid(index));\n                }\n                if(props.wellVolumeEstimationsFormValues != null && props.wellVolumeEstimationsFormValues[index]) {\n                    wellVolumeEstimationsGridData.push(props.wellVolumeEstimationsFormValues[index] );\n                } else {\n                    wellVolumeEstimationsGridData.push(populateWellVolumeEstimationsGrid(index));\n                }\n                return wellInfoValue;\n            });\n            setWellVolumeGrids(wellVolumeGridData);\n            setWellVolumeEstimationsGrids(wellVolumeEstimationsGridData);\n        }\n    }, props);\n\n    return (\n        <>\n            <Collapse defaultActiveKey={['1']} onChange={callback}>\n            {\n                props.wellInfoValues && props.wellInfoValues.map((well, index) => {\n                    return <Panel \n                        header={well[0].value}\n                        key={index+1}\n                        extra={\n                            wellVolumeGrids[index] && wellVolumeGrids[index].find(row => row.find(cell => cell.error) ? true : false)\n                            ? <Tooltip title=\"Please fill all the fields\"><i className=\"fas fa-exclamation-circle text-red-500\"></i></Tooltip>\n                            : \"\"\n                        }\n                    >\n                        <div className=\"flex\" key={index}>\n                            <div className=\"well-volume-grid\">\n                                <Grid \n                                    columns={TableHeadersUtil.wellVolumeFormTableData.columns}\n                                    grid={wellVolumeGrids[index]}\n                                    gridValueChanged={handleWellVolumeGridChanged}\n                                    index={index}\n                                ></Grid>\n                            </div>\n                            <div className=\"p-4\"></div>\n                            <div className=\"well-volume-estimation-grid\">\n                                <Grid\n                                    columns={TableHeadersUtil.wellVolumeEstimationsFormTableData.columns(well[0].value)}\n                                    grid={wellVolumeEstimationsGrids[index]}\n                                    gridValueChanged={handleWellVolumeEstimationsGridChanged}\n                                    index={index}\n                                ></Grid>\n                            </div>\n                        </div>\n                    </Panel>\n                })\n            }\n            </Collapse>\n            <div className=\"text-right mt-8\">\n                <Button type=\"primary\" onClick={(e) => {gotoNextStep()}}>\n                    Next\n                </Button>\n            </div>\n        </>\n    );\n}\n\n"]},"metadata":{},"sourceType":"module"}