{"ast":null,"code":"import _objectSpread from\"/Users/subodhkalika/test-projects/projects/seismos_application/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/subodhkalika/test-projects/projects/seismos_application/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import routes from\"routes/routes.js\";import axios from\"axiosConfig\";import config from\"config\";import{useSelector}from\"react-redux\";import{Layout,Menu,Breadcrumb,Spin}from'antd';import React,{useEffect,useState}from\"react\";import{useDispatch}from\"react-redux\";import{Switch,Route,Redirect,useHistory,useLocation}from\"react-router-dom\";import _ from\"lodash\";// components\nimport ENUMS from\"constants/appEnums\";import APP_CONSTANTS from\"constants/appConstants\";import AdminNavbar from\"components/Navbars/AdminNavbar.js\";import HttpUtil from\"util/HttpUtil\";import allActions from\"redux/actions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Content=Layout.Content,Sider=Layout.Sider;var SubMenu=Menu.SubMenu;export default function Admin(props){var history=useHistory();var location=useLocation();var dispatch=useDispatch();// const user = useSelector(state => state.authReducer.user);\nvar projectIds=useSelector(function(state){return state.authReducer.userProjectIds;});var _useState=useState(false),_useState2=_slicedToArray(_useState,2),noSidebarLayout=_useState2[0],setNoSidebarLayout=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),sidebarMenu=_useState4[0],setSidebarMenu=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),defaultSelectedMenuKey=_useState6[0],setDefaultSelectedMenuKey=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),defaultOpenMenu=_useState8[0],setDefaultOpenMenu=_useState8[1];// const [pages, setPages] = useState([]);\nvar getRoutes=function getRoutes(routes){if(!props.isAuthenticated){return/*#__PURE__*/_jsx(Redirect,{to:{pathname:'/auth/login',state:{from:props.location}}});}return routes.map(function(prop,key){if(prop.layout===ENUMS.ROUTES.ADMIN){return/*#__PURE__*/_jsx(Route,{path:prop.layout+prop.path,component:prop.component},key);}else{return null;}});};var menuChange=function menuChange(path,wellId,projectId){history.push({pathname:'/admin'+path,search:'?projectId='+projectId+'&wellId='+wellId,state:{projectId:projectId,wellId:wellId}});};var fetchProjectById=function fetchProjectById(projectId){if(projectId){//FETCH PROJECT DETAILS\naxios.get(config.API_URL+ENUMS.API_ROUTES.PROJECT_GET+'/'+projectId,_objectSpread({},HttpUtil.adminHttpHeaders())).then(function(res){if(res.status==200&&res.data){setNoSidebarLayout(false);var _projectId=res.data.data.project.id;dispatch(allActions.authActions.setCurrentProject(res.data.data.project));var wellInfo=_.sortBy(res.data.data.project.wells,function(w){return w.id;});var menu=wellInfo.map(function(well,index){return/*#__PURE__*/_jsxs(SubMenu,{title:well.well_name,children:[/*#__PURE__*/_jsx(Menu.Item,{onClick:function onClick(){menuChange(ENUMS.ROUTES.DATA_INPUT,well.id,_projectId);},children:\"Data input\"},\"data-input/\"+well.id),/*#__PURE__*/_jsx(Menu.Item,{onClick:function onClick(){menuChange(ENUMS.ROUTES.DAILY_LOG,well.id,_projectId);},children:\"Daily log\"},\"daily-log/\"+well.id),/*#__PURE__*/_jsx(Menu.Item,{onClick:function onClick(){menuChange(ENUMS.ROUTES.DEFAULT_VALUES,well.id,_projectId);},children:\"Default values\"},\"default-values/\"+well.id),/*#__PURE__*/_jsx(Menu.Item,{onClick:function onClick(){menuChange(ENUMS.ROUTES.TRACKING_SHEET,well.id,_projectId);},children:\"Tracking sheet\"},\"tracking-sheet/\"+well.id),/*#__PURE__*/_jsx(Menu.Item,{onClick:function onClick(){menuChange(ENUMS.ROUTES.OC_REPORT,well.id,_projectId);},children:\"QC report\"},\"qc-report/\"+well.id)]},\"menu\"+well.id);});setSidebarMenu(menu);}}).catch(function(error){if(error.response){console.log(error.response);}});}else{var notFoundUrl=ENUMS.ROUTES.AUTH+ENUMS.ROUTES.NOTFOUND;history.push(notFoundUrl);}};useEffect(function(){if(props.isAuthenticated){console.log('here',projectIds);if(APP_CONSTANTS.ROUTES_WITHOUT_SIDEBAR.indexOf(history.location.pathname)>-1){setNoSidebarLayout(true);setSidebarMenu([]);// setPages(history.location.pathname.split(\"/admin/\")[1].split(\"/\")[0].split(\"-\"));\n}else{if(sidebarMenu.length<1){if(location.state&&location.state.projectId){fetchProjectById(location.state.projectId);var subMenu=location.pathname.split(\"/admin/\")[1]+'/'+location.state.wellId;var mainMenu=\"menu\"+location.state.wellId;setDefaultSelectedMenuKey(subMenu);// sub - inside\nsetDefaultOpenMenu(mainMenu);// main\n}else if(location.search){var params=new URLSearchParams(location.search);var projectIdSearch=params.get('projectId');var wellIdSearch=params.get('wellId');fetchProjectById(projectIdSearch);var _subMenu=location.pathname.split(\"/admin/\")[1]+'/'+wellIdSearch;var _mainMenu=\"menu\"+wellIdSearch;setDefaultSelectedMenuKey(_subMenu);// sub - inside\nsetDefaultOpenMenu(_mainMenu);// main\n}else{var notFoundUrl=ENUMS.ROUTES.AUTH+ENUMS.ROUTES.NOTFOUND;history.push(notFoundUrl);}}// const defaultSelectedSubMenu = history.location.pathname.split(\"/admin/\")[1];\n// const defaultOpenMenu = \"menu\" + history.location.pathname.split(\"/admin/\")[1].split(\"/\")[1];\n// console.log(defaultSelectedSubMenu)\n// setDefaultSelectedMenuKey(defaultSelectedSubMenu);\n// setDefaultOpenMenu(defaultOpenMenu);\n// console.log(defaultOpenMenu);\n// setNoSidebarLayout(false);\n// if project is selected\n// if(!_.isEmpty(project)) {\n//     const menuChange = (path, id) => {\n//         history.push('/admin' + path + '/'+ id)\n//     }\n//     // const wellInfo = project.wellInfoValues;\n//     console.log(wellInfo);\n//     const menu = wellInfo.map((well, index) => {\n//         return <SubMenu key={\"menu\"+(well.id)} title={well.well_name}>\n//             <Menu.Item key={\"data-input/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.DATA_INPUT, well.id) }}>Data input</Menu.Item>\n//             <Menu.Item key={\"daily-log/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.DAILY_LOG, well.id) }}>Daily log</Menu.Item>\n//             <Menu.Item key={\"default-values/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.DEFAULT_VALUES, well.id) }}>Default values</Menu.Item>\n//             <Menu.Item key={\"tracking-sheet/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.TRACKING_SHEET, well.id) }}>Tracking sheet</Menu.Item>\n//             <Menu.Item key={\"qc-report/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.OC_REPORT, well.id) }}>QC report</Menu.Item>\n//         </SubMenu>\n//     });\n//     console.log(menu)\n//     setSidebarMenu(menu);\n// };\n}}else{history.push('/auth/login');}},[]);useEffect(function(){return history.listen(function(location){if(props.isAuthenticated){if(APP_CONSTANTS.ROUTES_WITHOUT_SIDEBAR.indexOf(history.location.pathname)>-1){setNoSidebarLayout(true);setSidebarMenu([]);// setPages(history.location.pathname.split(\"/admin/\")[1].split(\"/\")[0].split(\"-\"));\n}else{if(sidebarMenu.length<1){if(location.state&&location.state.projectId){fetchProjectById(location.state.projectId);}else if(location.search){var params=new URLSearchParams(location.search);var projectIdSearch=params.get('projectId');fetchProjectById(projectIdSearch);}}}}else{history.push('/auth/login');}});},[history]);return/*#__PURE__*/_jsx(_Fragment,{children:noSidebarLayout?/*#__PURE__*/_jsxs(Layout,{className:\"layout\",children:[/*#__PURE__*/_jsx(AdminNavbar,{withLogo:true}),/*#__PURE__*/_jsx(Content,{style:{padding:'0 50px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"site-layout-content mb-12 p-5 bg-white\",children:/*#__PURE__*/_jsxs(Switch,{children:[getRoutes(routes),/*#__PURE__*/_jsx(Redirect,{from:\"*\",to:\"/admin/dashboard\"})]})})})]}):sidebarMenu.length>0?/*#__PURE__*/_jsxs(Layout,{children:[/*#__PURE__*/_jsxs(Sider,{style:{overflow:'auto',height:'100vh',position:'fixed',left:0},width:250,className:\"site-layout-background\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"seismos logo\",src:require(\"assets/img/seismos/seismos_logo_animated.gif\").default})}),/*#__PURE__*/_jsx(Menu,{theme:\"\",mode:\"inline\",defaultSelectedKeys:[defaultSelectedMenuKey],defaultOpenKeys:[defaultOpenMenu],className:\"sidebar-margin-top\",children:sidebarMenu})]}),/*#__PURE__*/_jsxs(Layout,{className:\"site-layout with-sedebar\",style:{marginLeft:250},children:[/*#__PURE__*/_jsx(AdminNavbar,{withLogo:false}),/*#__PURE__*/_jsx(Content,{style:{margin:'88px 16px 0',overflow:'initial'},children:/*#__PURE__*/_jsxs(Switch,{children:[getRoutes(routes),/*#__PURE__*/_jsx(Redirect,{from:\"*\",to:\"/admin/dashboard\"})]})})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"spin-overlay\",children:/*#__PURE__*/_jsx(Spin,{size:\"large\",spinning:true})})});}","map":{"version":3,"sources":["/Users/subodhkalika/test-projects/projects/seismos_application/client/src/layouts/Admin.js"],"names":["routes","axios","config","useSelector","Layout","Menu","Breadcrumb","Spin","React","useEffect","useState","useDispatch","Switch","Route","Redirect","useHistory","useLocation","_","ENUMS","APP_CONSTANTS","AdminNavbar","HttpUtil","allActions","Content","Sider","SubMenu","Admin","props","history","location","dispatch","projectIds","state","authReducer","userProjectIds","noSidebarLayout","setNoSidebarLayout","sidebarMenu","setSidebarMenu","defaultSelectedMenuKey","setDefaultSelectedMenuKey","defaultOpenMenu","setDefaultOpenMenu","getRoutes","isAuthenticated","pathname","from","map","prop","key","layout","ROUTES","ADMIN","path","component","menuChange","wellId","projectId","push","search","fetchProjectById","get","API_URL","API_ROUTES","PROJECT_GET","adminHttpHeaders","then","res","status","data","project","id","authActions","setCurrentProject","wellInfo","sortBy","wells","w","menu","well","index","well_name","DATA_INPUT","DAILY_LOG","DEFAULT_VALUES","TRACKING_SHEET","OC_REPORT","catch","error","response","console","log","notFoundUrl","AUTH","NOTFOUND","ROUTES_WITHOUT_SIDEBAR","indexOf","length","subMenu","split","mainMenu","params","URLSearchParams","projectIdSearch","wellIdSearch","listen","padding","overflow","height","position","left","require","default","marginLeft","margin"],"mappings":"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","sourcesContent":["import routes from \"routes/routes.js\";\nimport axios from \"axiosConfig\";\nimport config from \"config\";\nimport { useSelector } from \"react-redux\";\nimport { Layout, Menu, Breadcrumb, Spin } from 'antd';\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { Switch, Route, Redirect, useHistory, useLocation } from \"react-router-dom\";\nimport _ from \"lodash\";\n\n// components\nimport ENUMS from \"constants/appEnums\";\nimport APP_CONSTANTS from \"constants/appConstants\";\nimport AdminNavbar from \"components/Navbars/AdminNavbar.js\";\nimport HttpUtil from \"util/HttpUtil\";\nimport allActions from \"redux/actions\";\n\n\nconst { Content, Sider } = Layout;\nconst { SubMenu } = Menu;\n\nexport default function Admin(props) {\n    const history = useHistory();\n    const location = useLocation();\n\n    const dispatch = useDispatch();\n\n    // const user = useSelector(state => state.authReducer.user);\n    const projectIds = useSelector(state => state.authReducer.userProjectIds);\n    \n    const [noSidebarLayout, setNoSidebarLayout] = useState(false);\n    const [sidebarMenu, setSidebarMenu] = useState([]);\n    const [defaultSelectedMenuKey, setDefaultSelectedMenuKey] = useState();\n    const [defaultOpenMenu, setDefaultOpenMenu] = useState();\n    // const [pages, setPages] = useState([]);\n\n    const getRoutes = (routes) => {\n        if (!props.isAuthenticated) {\n          return <Redirect to={{\n              pathname: '/auth/login',\n              state: { from: props.location }\n            }}\n          />\n        }\n        return routes.map((prop, key) => {\n        if (prop.layout === ENUMS.ROUTES.ADMIN) {\n            return (\n            <Route\n                path={prop.layout + prop.path}\n                component={prop.component}\n                key={key}\n            />\n            );\n        } else {\n            return null;\n        }\n        });\n    };\n\n    const menuChange = (path, wellId, projectId) => {\n        history.push({\n            pathname: '/admin' + path,\n            search: '?projectId=' + projectId + '&wellId=' + wellId,\n            state: { projectId: projectId, wellId: wellId }\n        });\n    }\n\n    const fetchProjectById = (projectId) => {\n        if (projectId) {\n            //FETCH PROJECT DETAILS\n            axios.get(config.API_URL + ENUMS.API_ROUTES.PROJECT_GET + '/' + projectId,\n            {\n                ...HttpUtil.adminHttpHeaders(),\n            })\n            .then(res => {\n                if(res.status == 200 && res.data) {\n                    setNoSidebarLayout(false);\n                    const projectId = res.data.data.project.id;\n                    dispatch(allActions.authActions.setCurrentProject(res.data.data.project));\n                    const wellInfo = _.sortBy(res.data.data.project.wells, function(w) { return w.id; });\n                    const menu = wellInfo.map((well, index) => {\n                        return <SubMenu key={\"menu\"+(well.id)} title={well.well_name}>\n                            <Menu.Item key={\"data-input/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.DATA_INPUT, well.id, projectId) }}>Data input</Menu.Item>\n                            <Menu.Item key={\"daily-log/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.DAILY_LOG, well.id, projectId) }}>Daily log</Menu.Item>\n                            <Menu.Item key={\"default-values/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.DEFAULT_VALUES, well.id, projectId) }}>Default values</Menu.Item>\n                            <Menu.Item key={\"tracking-sheet/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.TRACKING_SHEET, well.id, projectId) }}>Tracking sheet</Menu.Item>\n                            <Menu.Item key={\"qc-report/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.OC_REPORT, well.id, projectId) }}>QC report</Menu.Item>\n                        </SubMenu>\n                    });\n                    setSidebarMenu(menu);\n                }\n            })\n            .catch(error => {\n                if (error.response) {\n                    console.log(error.response);\n                }\n            })\n        } else {\n            const notFoundUrl = ENUMS.ROUTES.AUTH + ENUMS.ROUTES.NOTFOUND;\n            history.push(notFoundUrl);\n        }\n    }\n\n    useEffect(() => {\n        if (props.isAuthenticated) {\n            console.log('here', projectIds)\n            if (APP_CONSTANTS.ROUTES_WITHOUT_SIDEBAR.indexOf(history.location.pathname) > -1) {\n                setNoSidebarLayout(true);\n                setSidebarMenu([]);\n                // setPages(history.location.pathname.split(\"/admin/\")[1].split(\"/\")[0].split(\"-\"));\n            } else {\n                if (sidebarMenu.length < 1) {\n                    if (location.state && location.state.projectId) {\n                        fetchProjectById(location.state.projectId);\n\n                        const subMenu = location.pathname.split(\"/admin/\")[1] + '/' + location.state.wellId;\n                        const mainMenu = \"menu\" + location.state.wellId;\n                        setDefaultSelectedMenuKey(subMenu); // sub - inside\n                        setDefaultOpenMenu(mainMenu); // main\n                    }\n                    else if (location.search) {\n                        const params = new URLSearchParams(location.search);\n                        const projectIdSearch = params.get('projectId');\n                        const wellIdSearch = params.get('wellId');\n                        fetchProjectById(projectIdSearch);\n                        \n                        const subMenu = location.pathname.split(\"/admin/\")[1] + '/' + wellIdSearch;\n                        const mainMenu = \"menu\" + wellIdSearch;\n                        setDefaultSelectedMenuKey(subMenu); // sub - inside\n                        setDefaultOpenMenu(mainMenu); // main\n                    } else {\n                        const notFoundUrl = ENUMS.ROUTES.AUTH + ENUMS.ROUTES.NOTFOUND;\n                        history.push(notFoundUrl);\n                    }\n                }\n                // const defaultSelectedSubMenu = history.location.pathname.split(\"/admin/\")[1];\n                // const defaultOpenMenu = \"menu\" + history.location.pathname.split(\"/admin/\")[1].split(\"/\")[1];\n                // console.log(defaultSelectedSubMenu)\n                // setDefaultSelectedMenuKey(defaultSelectedSubMenu);\n                // setDefaultOpenMenu(defaultOpenMenu);\n                // console.log(defaultOpenMenu);\n                // setNoSidebarLayout(false);\n                // if project is selected\n                // if(!_.isEmpty(project)) {\n                //     const menuChange = (path, id) => {\n                //         history.push('/admin' + path + '/'+ id)\n                //     }\n                    \n                //     // const wellInfo = project.wellInfoValues;\n                //     console.log(wellInfo);\n                //     const menu = wellInfo.map((well, index) => {\n                //         return <SubMenu key={\"menu\"+(well.id)} title={well.well_name}>\n                //             <Menu.Item key={\"data-input/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.DATA_INPUT, well.id) }}>Data input</Menu.Item>\n                //             <Menu.Item key={\"daily-log/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.DAILY_LOG, well.id) }}>Daily log</Menu.Item>\n                //             <Menu.Item key={\"default-values/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.DEFAULT_VALUES, well.id) }}>Default values</Menu.Item>\n                //             <Menu.Item key={\"tracking-sheet/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.TRACKING_SHEET, well.id) }}>Tracking sheet</Menu.Item>\n                //             <Menu.Item key={\"qc-report/\" + well.id} onClick={() => { menuChange(ENUMS.ROUTES.OC_REPORT, well.id) }}>QC report</Menu.Item>\n                //         </SubMenu>\n                //     });\n                //     console.log(menu)\n                //     setSidebarMenu(menu);\n                // };\n            }\n        } else {\n            history.push('/auth/login')\n        }\n    }, []);\n\n    useEffect(() => {\n        return history.listen((location) => {\n            if (props.isAuthenticated) {\n                if (APP_CONSTANTS.ROUTES_WITHOUT_SIDEBAR.indexOf(history.location.pathname) > -1) {\n                    setNoSidebarLayout(true);\n                    setSidebarMenu([]);\n                    // setPages(history.location.pathname.split(\"/admin/\")[1].split(\"/\")[0].split(\"-\"));\n                } else {\n                    if (sidebarMenu.length < 1) {\n                        if (location.state && location.state.projectId) {\n                            fetchProjectById(location.state.projectId);\n                        }\n                        else if (location.search) {\n                            const params = new URLSearchParams(location.search);\n                            const projectIdSearch = params.get('projectId');\n                            fetchProjectById(projectIdSearch);\n                        }\n                    }\n                }\n            } else {\n                history.push('/auth/login')\n            }\n        }) \n    }, [history])\n\n    return (\n        <>\n            {\n                noSidebarLayout\n                ? <Layout className=\"layout\">\n                    <AdminNavbar withLogo={true} />\n                    <Content style={{ padding: '0 50px' }}>\n                        {/* <Breadcrumb style={{ margin: '16px 0' }}>\n                            {\n                                pages.map((page, index) => {\n                                    return <Breadcrumb.Item key={index}><span className=\"capitalize\">{page}</span></Breadcrumb.Item>\n                                })\n                            }\n                            \n                        </Breadcrumb> */}\n                            {/* <Breadcrumb.Item>List</Breadcrumb.Item>\n                            <Breadcrumb.Item>App</Breadcrumb.Item> */}\n                        <div className=\"site-layout-content mb-12 p-5 bg-white\">\n                            <Switch>\n                                {getRoutes(routes)}\n                                <Redirect from=\"*\" to=\"/admin/dashboard\" />\n                            </Switch>\n                        </div>\n                    </Content>\n                </Layout>\n                : ((sidebarMenu.length > 0)\n                    ? <Layout>\n                        <Sider\n                            style={{\n                                overflow: 'auto',\n                                height: '100vh',\n                                position: 'fixed',\n                                left: 0,\n                            }}\n                            width={250}\n                            className=\"site-layout-background\"\n                        >\n                            <div className=\"logo\"><img alt=\"seismos logo\" src={require(\"assets/img/seismos/seismos_logo_animated.gif\").default}></img></div>\n                            <Menu theme=\"\" mode=\"inline\" defaultSelectedKeys={[defaultSelectedMenuKey]} defaultOpenKeys={[defaultOpenMenu]} className=\"sidebar-margin-top\">\n                                {sidebarMenu}\n                            </Menu>\n                        </Sider>\n                        <Layout className=\"site-layout with-sedebar\" style={{ marginLeft: 250 }}>\n                            <AdminNavbar withLogo={false}/>\n                            <Content style={{ margin: '88px 16px 0', overflow: 'initial' }}>\n                                <Switch>\n                                    {getRoutes(routes)}\n                                    <Redirect from=\"*\" to=\"/admin/dashboard\" />\n                                </Switch>\n                            </Content>\n                        </Layout>\n                    </Layout>\n                    : (<div className=\"spin-overlay\"><Spin size=\"large\" spinning={true}></Spin></div>))\n            }\n        </>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}